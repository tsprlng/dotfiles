#!/usr/bin/ruby

ActualGit='/usr/bin/git'

if ARGV.include? 'commit' and ARGV.any? {|a| a =~ /\A-[b-z]*a/ }
	state = `git status -s`.lines
	added = state.any?{|l| l=~ /\A[^\? ]/ }
	unadded = state.any?{|l| l=~ /\A [^\? ]/ }
	if added and unadded
		$stderr.puts "You silly idiot, you're using commit -a when you've already staged some stuff."
		exit 4
	end
end

exec(ActualGit, *ARGV)
