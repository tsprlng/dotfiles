#!/bin/bash

exec 2>/dev/null

get() {
  local vols="$(pactl list sinks | grep -e Volume -e 'Mute.*yes' | egrep -o -e Mute -e '[0123456789]+%')"
  if [[ "$vols" =~ Mute* ]]; then
    echo "$vols" | head -n 2 | tac
  else
    echo "$vols" | head -n 1
  fi
}

notify() {
 it=$(get)
 if [[ "$it" =~ M ]]; then
  volnoti-show -m || true
 else
  volnoti-show "$it" || true
 fi
}

if [[ "$@" =~ up ]]; then
  pactl set-sink-volume @DEFAULT_SINK@ '+3%'
  notify
elif [[ "$@" =~ down ]]; then
  pactl set-sink-volume @DEFAULT_SINK@ '-3%'
  notify
elif [[ "$@" =~ mute ]]; then
  pactl set-sink-mute @DEFAULT_SINK@ toggle
  notify
elif [[ "$@" =~ zero ]]; then
  pactl set-sink-volume @DEFAULT_SINK@ '0%'
  pactl set-sink-mute @DEFAULT_SINK@ off
  notify
elif [[ "$@" =~ notify ]]; then
  notify
else
  get
fi

exit 0
