#!/usr/bin/zsh

exec 2>/dev/null

zmodload zsh/zselect

get() {
  xbacklight
}

notify() {
 pkill -USR1 -o -f ~/bin/i3status
}

step=3
curr="$(get)"
if (( "${curr%%.*}" < 20 )); then
	step='1'
fi

if [[ "$@" =~ up ]]; then
  xbacklight +$step -steps 1 -time 1
  notify
elif [[ "$@" =~ down ]]; then
  xbacklight -$step -steps 1 -time 1
  notify
elif [[ "$@" =~ max ]]; then
  xbacklight '=100' -steps 1 -time 1
  notify
elif [[ "$@" =~ min ]]; then
  zselect -t 80
  xset dpms force off
elif [[ "$@" =~ notify ]]; then
  notify
else
  get
fi

exit 0
